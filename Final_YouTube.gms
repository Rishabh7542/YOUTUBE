Sets

j videos/1*50/,k likes/fr,ot/, d servers/s1,s2,s3/, t tags/t1,t2,t3,t4,t5,t6,t7,t8,t9,t10/, q quality/l,m,h/,c capacity/C1,C2,C3/;
Alias(j, jmod);

Table Like(k,j) Likes of video j at likes k
         1       2       3       4       5       6       7       8       9       10      11      12      13      14      15      16      17      18      19      20      21      22      23      24      25      26      27      28      29      30      31      32      33      34      35      36      37      38      39      40      41      42      43      44      45      46      47      48      49      50
fr      10       3       2       6       8       13      2       4       20      12      0       25      21      22      11      9       3       16      29      2       19      27      10      0       29      4       28      8       13      6       19      26      8        0      1       23      16      15      17      6       25      11      0       19      18      13      22      12      3       30
ot      101     450     413     497     321     214     305     315     352      452    491     186     136     379      48     159      94     436      84     120     281      434     454    473     218      79     319      58      413    451     444     440     439      362    160     499      207     128     116    142      459     321     49      367     158     287     407     373    108      390;

Table Server(d,j) Server for jth video
         1       2       3       4       5       6       7       8       9       10      11      12      13      14      15      16      17      18      19      20      21      22      23      24      25      26      27      28      29      30      31      32      33      34      35      36      37      38      39      40      41      42      43      44      45      46      47      48      49      50
s1       0       1       1       0       1       1       0       0       0       1       0        1       1       1       0       0       1       1       1       0       0       1       0       0       0       1       1       0       1       0       0       1       0       1       1       1       1       0       1       0       1       0       0       0       1       1       0       1       0       1
s2       1       0       1       1       1       0       0       1       0       0       1        1       1       0       1       0       0       1       0       1       1       1       1       0       1       0       0       1       0       1       1       1       1       0       1       0       1       1       0       0       1       1       0       1       1       0       1       1       1       0
s3       1       1       1       0       1       0       1       1       1       0       1        1       1       0       1       1       1       1       0       0       1       1       1       1       1       1       1       0       1       1       1       0       1       1       1       1       0       1       1       1       1       1       1       1       1       1       0       1       1       1;

Table Tags(t,j)  Tags for jth video
         1       2       3       4       5       6       7       8       9       10      11      12      13      14      15      16      17      18      19      20      21      22      23      24      25      26      27      28      29      30      31      32      33      34      35      36      37      38      39      40      41      42      43      44      45      46      47      48      49      50
t1       0       1       0       1       0       1       0       0       0        1       1       0       0       0       0       0       0       1       0       0       0       0       1       0       1       1       0       0       0       0       0       0       0       0       0       0       0       1       0       1       0       0       0       0       0       0       1       0       0       0
t2       0       0       0       0       1       0       0       1       0        0       1       0       0       1       1       0       0       0       0       1       0       0       0       0       0       0       0       0       0       0       0       0       1       0       0       0       0       0       0       0       0       0       0       0       1       1       1       0       0       0
t3       1       0       0       0       0       0       1       0       0        0       0       0       1       0       0       0       0       0       0       0       0       0       0       1       0       0       0       1       0       0       0       0       0       1       0       0       0       0       1       0       0       0       1       0       0       0       0       1       0       0
t4       0       0       1       1       0       0       0       1       1        0       0       1       0       1       0       1       0       0       1       1       1       0       0       0       0       1       1       0       0       1       0       1       0       1       0       1       0       0       0       0       0       1       0       0       0       1       0       0       0       1
t5       0       1       0       0       0       1       1       0       0        0       0       0       0       1       1       1       0       0       1       0       0       0       1       0       1       0       0       0       0       0       1       1       0       0       1       0       0       0       0       0       0       1       1       1       0       0       0       0       1       0
t6       1       0       1       0       1       0       0       0       1        0       0       0       0       1       0       0       1       1       0       0       0       1       0       0       0       0       0       0       1       1       0       0       0       0       1       1       1       1       0       1       1       0       1       0       0       0       0       0       1       1
t7       1       1       1       0       0       1       0       0       1        0       0       0       0       0       1       1       1       0       0       0       1       0       0       0       0       1       0       0       1       1       1       0       1       0       0       0       0       1       0       0       0       0       0       1       1       1       0       1       1       1
t8       0       0       1       1       1       0       1       1       1        1       0       1       0       0       1       0       0       0       0       0       0       0       0       1       1       0       0       1       0       0       1       1       1       0       0       1       1       1       0       0       1       1       0       0       0       1       0       1       0       1
t9       1       0       0       1       0       0       1       0       0        1       1       1       1       0       1       1       1       1       1       1       0       1       1       1       1       0       1       1       1       1       1       0       0       0       1       1       1       1       1       1       0       0       0       0       1       1       1       0       0       0
t10      0       1       1       1       0       1       1       0       1        1       0       0       0       1       0       1       0       0       0       0       1       0       0       0       0       1       0       1       0       0       0       1       1       1       1       1       1       0       0       1       1       0       0       0       0       1       0       0       1       1;

Table Quality(q,j) File size for jth video
         1          2           3           4           5           6           7           8           9           10          11          12          13          14          15          16          17          18          19          20         21          22          23          24          25          26          27          28          29          30          31          32          33          34          35          36          37          38          39          40          41          42          43          44          45          46          47          48          49          50
l      3730        3413        2449        2399        3884        3018        4950        2513        4567        3749        2323        2536        4660        2127        4919        4494        2046        2158        3999        4646        2572        3851        4454        3796        2503        2290        3361        3198        2318        3268        4000        3107        2361        4948        2067        4100        3501        4168        2250        3971        3469        3253        4998        2469        3154        3752        2484        2206        2503        2290 
m      6955        6164        8597        8536        8947        6628        6616        7335        6618        8186        7196        8527        7602        8552        7838        8216        8307        7657        6439        6371        8844        8214        6401        7677        6269        7682        8970        7758        7744        7890        6567        7471        6246        6190        6092        8563        6409        8090        7439        7999        7740        7844        7906        8622        6426        8804        6904        7338        6569        8637
h     10590       10501       12342       11063       11537       13807       11470       11440       10639       14715       12916       12990       14943       10890       14561       14475       12280       13155       13732       13463       12748       13419       13700       13947        12700       11798       10520       10357       10508       10449       10051       12783       12426       10660       11174       11838       13535       10283       13728       11212       14977       10404       10242       11983       14453       13614       13675       11030       14998       12609;

Parameters Latency(d) Each cache server latency time in milliseconds
/s1 250,s2 300,s3 500/;

Parameters Watchtime(j) of video j in seconds
/1   29, 2    14, 3    38, 4    38, 5   100, 6   106, 7    56, 8   112, 9    52, 10    68, 11    99, 12    79, 13   119, 14    68, 15   120, 16    90, 17    90, 18   113, 19  115, 20    54, 21    98, 22    81, 23   115, 24    52, 25    29, 26    90, 27    52, 28    13, 29    69, 30   114, 31    37, 32    66, 33    34, 34    14, 35    29, 36    20, 37   67, 38    68, 39   113, 40    95, 41   104, 42    34, 43   103, 44    81, 45    98, 46    35, 47    12, 48    14, 49    95, 50    74/;

Parameters Similarity(j) of video j between 0 to 1
/1  1,2 0.25,3  0.4472136,4 0.2236068 ,5 0.28867513,6  0.25,7  0.4472136 ,8  0,9 0.4472136 ,10  0.25,11  0.28867513,12  0.28867513,13  0.70710678,14  0.2236068 ,15  0.4472136 ,16  0.4472136 ,17  0.8660254 ,18  0.57735027,19  0.28867513,20  0.28867513,21  0.28867513,22  0.70710678,23 0.28867513,24  0.57735027,25  0.25,26  0.25,27  0.35355339,28  0.5,29  0.8660254 ,30  0.75,31  0.5,32  0,33  0.25,34  0.28867513,35  0.5,36  0.4472136 ,37  0.5,38  0.67082039,39  0.70710678,40  0.5,41  0.28867513,42  0,43  0.57735027,44  0.35355339,45  0.57735027,46  0.40824829,47  0.28867513,48  0.57735027,49  0.5,50  0.4472136/;      

Scalar InternetUsage in megabytes
/1024000/;

Scalar target in index
/0/;

Scalar ScreenTime in seconds
/90000/;

Scalar n DisplaySize in numbers ...it must be even
/14/;

Scalar AL Average Latency in milliseconds
/530/; 

Variables Obj,Low(j),Med(j),High(j),F(j),Suggestion(j);
Positive Variables TotalLikes(j);
Binary Variables Low(j),Med(j),High(j),F(j),Z(j);

Equations
Quality_Eqn(j),Likability_Eqn(j),Time_constraint,Bandwidth_constraint,Eqn_TotalLikes(j),Eqn_ImageCount,Eqn2(j),Sol,Extra(j),Eqn_MedQualityCount,Eqn8;


Sol..Obj=E=10*sum(j,Similarity(j)*Z(j)) + sum(j,Z(j)*(1-F(j))*log(0.0001 + TotalLikes(j)/40) + F(j)*(log(0.0001 + TotalLikes(j)/10)) + F(j)*0.066*cvPower(Like('fr',j), 1-10/(0.001+Like('fr',j))));


Quality_Eqn(j)..Low(j)+Med(j)+High(j)=E=Z(j);


Likability_Eqn(j).. F(j) =e= sign(Like('fr',j));


Bandwidth_constraint..sum(j,Quality('l',j)*Low(j))+sum(j,Quality('m',j)*Med(j))+sum(j,Quality('h',j)*High(j))=L=InternetUsage;


Eqn_TotalLikes(j)..TotalLikes(j)=E=Like('fr',j)+Like('ot',j);


Eqn_ImageCount..sum(j,Z(j))=e=n;


Eqn_MedQualityCount..sum(j,med(j))=e=n/2;


Time_constraint..sum(j, Z(j)*Watchtime(j))=l= ScreenTime;


Extra(j)..Suggestion(j) =e= Z(j);


Eqn2(j)..Z(j)*(Server('s1',j)+Server('s2',j)+Server('s3',j))=L=3;


Eqn8..sum((d,j),Server(d,j)*Latency(d)*Z(j)/1000)=L=AL*n;




*Eqn4(j)..Suggestion(j)=L=10000*Z(j);
*Sol(j)..Obj=E= sum(jmod,Similarity(jmod)*Z(jmod))*100 + 10*(1-F(j))*log(0.0001 + TotalLikes(j)/100) + F(j)*(log(0.0001 + TotalLikes(j)/10)) + F(j)*0.066*cvPower(Like('fr',j), 1-10/(0.1+Like('fr',j)));
*Sol(j)..Obj=E=sum(jmod,Similarity(jmod)*Z(jmod))*6000 + 20*F(j)*Like('fr',j) + 10*Like('ot',j) + 10*(TotalLikes(j));

Model YouTube /all/;
Solve Youtube using MINLP maximizing Obj;
Display Suggestion.L,high.L,med.L,low.L;